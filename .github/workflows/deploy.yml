name: deploy

on:
 push:
  branches:
   - main

jobs:
 deploy:
  runs-on: ubuntu-latest
  steps:
   - uses: actions/checkout@v2
     with:
      persist-credentials: false
      fetch-depth: 0
   - uses: actions/setup-node@v2-beta
     with:
      node-version: 14
   - run: npm version minor
   - run: |
      git config --local user.email "action@github.com"
      git config --local user.name "GitHub Action"
      git commit -am 'bump version'
   - uses: ad-m/github-push-action@master
     with:
      github_token: ${{ secrets.GITHUB_TOKEN }}
      branch: ${{ github.ref }}
   - run: npm publish
